/*! angular-applicationinsights version 0.2.6 2015-11-19 */
!function(a){var b={};b.angular=a,function(a){function b(a,b,c,e,f,g){d(a)||this.setFunctionName(a),d(f)||this.setColumnNumber(f),d(b)||this.setArgs(b),d(c)||this.setFileName(c),d(e)||this.setLineNumber(e),d(g)||this.setLevelNumber(g)}var c=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},d=a.angular.isUndefined;b.prototype={getFunctionName:function(){return this.method},setFunctionName:function(a){this.method=String(a)},getArgs:function(){return this.args},setArgs:function(a){if("[object Array]"!==Object.prototype.toString.call(a))throw new TypeError("Args must be an Array");this.args=a},getFileName:function(){return this.fileName},setFileName:function(a){this.fileName=String(a)},getLineNumber:function(){return this.line},setLineNumber:function(a){return c(a)?void(this.line=Number(a)):void(this.line=void 0)},getColumnNumber:function(){return this.columnNumber},setColumnNumber:function(a){return c(a)?void(this.columnNumber=Number(a)):void(this.columnNumber=void 0)},setLevelNumber:function(a){if(!c(a))throw new TypeError("Level Number must be a Number");this.level=Number(a)},toString:function(){var a=this.getFunctionName()||"{anonymous}",b="("+(this.getArgs()||[]).join(",")+")",d=this.getFileName()?"@"+this.getFileName():"",e=c(this.getLineNumber())?":"+this.getLineNumber():"",f=c(this.getColumnNumber())?":"+this.getColumnNumber():"";return a+b+d+e+f}},a.StackFrame=b}(b),function(a){var b=a.StackFrame,c=/\S+\:\d+/,d=/\s+at /,e={parse:function(a){return"undefined"!=typeof a.stacktrace||"undefined"!=typeof a["opera#sourceloc"]?this.parseOpera(a):a.stack&&a.stack.match(d)?this.parseV8OrIE(a):a.stack&&a.stack.match(c)?this.parseFFOrSafari(a):null},extractLocation:function(a){if(-1===a.indexOf(":"))return[];var b=a.split(":"),c=b.pop(),d=b[b.length-1];if(!isNaN(parseFloat(d))&&isFinite(d)){var e=b.pop();return[b.join(":"),e,c]}return[b.join(":"),c,void 0]},parseV8OrIE:function(a){var c=0;return a.stack.split("\n").slice(1).map(function(a){var d=a.replace(/^\s+/,"").split(/\s+/).slice(1),e=void 0!==d[0]?this.extractLocation(d.pop().replace(/[\(\)\s]/g,"")):["unknown","unknown","unknown"],f=d[0]&&"Anonymous"!==d[0]?d[0]:"unknown";return new b(f,void 0,e[0],e[1],e[2],c++)},this)},parseFFOrSafari:function(a){var d=0;return a.stack.split("\n").filter(function(a){return!!a.match(c)},this).map(function(a){var c=a.split("@"),e=this.extractLocation(c.pop()),f=c.shift()||"unknown";return new b(f,void 0,e[0],e[1],e[2],d++)},this)},parseOpera:function(a){return!a.stacktrace||a.message.indexOf("\n")>-1&&a.message.split("\n").length>a.stacktrace.split("\n").length?this.parseOpera9(a):a.stack?this.parseOpera11(a):this.parseOpera10(a)},parseOpera9:function(a){for(var c=/Line (\d+).*script (?:in )?(\S+)/i,d=a.message.split("\n"),e=[],f=0,g=2,h=d.length;h>g;g+=2){var i=c.exec(d[g]);i&&e.push(new b(void 0,void 0,i[2],i[1],void 0,f++))}return e},parseOpera10:function(a){for(var c=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,d=a.stacktrace.split("\n"),e=[],f=0,g=0,h=d.length;h>g;g+=2){var i=c.exec(d[g]);i&&e.push(new b(i[3]||void 0,void 0,i[2],i[1],void 0,f++))}return e},parseOpera11:function(a){var d=0;return a.stack.split("\n").filter(function(a){return!!a.match(c)&&!a.match(/^Error created at/)},this).map(function(a){var c,e=a.split("@"),f=this.extractLocation(e.pop()),g=e.shift()||"",h=g.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;g.match(/\(([^\)]*)\)/)&&(c=g.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var i=void 0===c||"[arguments not available]"===c?void 0:c.split(",");return new b(h,i,f[0],f[1],f[2],d++)},this)}};a.errorStackParser=e}(b),function(a,b){"use strict";function c(a){return/^-?\d+\.?\d*$/.test(a.replace(/["']/g,""))}var d=(b.isDefined,b.isUndefined),e=b.isNumber,f=b.isObject,g=b.isArray,h=b.extend,i=b.toJson,j=b.fromJson,k={prefix:"ls",storageType:"localStorage",cookie:{expiry:30,path:"/"},notify:{setItem:!0,removeItem:!1}};a.storage=function(a){{var b,l=h(k,a),m=l,n=l.prefix,o=l.cookie,p=l.notify,q=l.storageType,r=l.rootScope,s=l.window,t=l.document;l.parse}t?t[0]&&(t=t[0]):t=document,"."!==n.substr(-1)&&(n=n?n+".":"");var u=function(a){return n+a},v=function(){try{var a=q in s&&null!==s[q],c=u("__"+Math.round(1e7*Math.random()));return a&&(b=s[q],b.setItem(c,""),b.removeItem(c)),a}catch(d){return q="cookie",r.$broadcast("LocalStorageModule.notification.error",d.message),!1}}(),w=function(a,c){if(d(c)?c=null:(f(c)||g(c)||e(+c||c))&&(c=i(c)),!v||"cookie"===m.storageType)return v||r.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p.setItem&&r.$broadcast("LocalStorageModule.notification.setitem",{key:a,newvalue:c,storageType:"cookie"}),z(a,c);try{(f(c)||g(c))&&(c=i(c)),b&&b.setItem(u(a),c),p.setItem&&r.$broadcast("LocalStorageModule.notification.setitem",{key:a,newvalue:c,storageType:m.storageType})}catch(h){return r.$broadcast("LocalStorageModule.notification.error",h.message),z(a,c)}return!0},x=function(a){if(!v||"cookie"===m.storageType)return v||r.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),A(a);var d=b?b.getItem(u(a)):null;return d&&"null"!==d?"{"===d.charAt(0)||"["===d.charAt(0)||c(d)?j(d):d:null},y=function(){try{return s.navigator.cookieEnabled||"cookie"in t&&(t.cookie.length>0||(t.cookie="test").indexOf.call(t.cookie,"test")>-1)}catch(a){return r.$broadcast("LocalStorageModule.notification.error",a.message),!1}}(),z=function(a,b){if(d(b))return!1;if((g(b)||f(b))&&(b=i(b)),!y)return r.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var c="",e=new Date,h="";if(null===b?(e.setTime(e.getTime()+-864e5),c="; expires="+e.toGMTString(),b=""):0!==o.expiry&&(e.setTime(e.getTime()+24*o.expiry*60*60*1e3),c="; expires="+e.toGMTString()),a){var j="; path="+o.path;o.domain&&(h="; domain="+o.domain),t.cookie=u(a)+"="+encodeURIComponent(b)+c+j+h}}catch(k){return r.$broadcast("LocalStorageModule.notification.error",k.message),!1}return!0},A=function(a){if(!y)return r.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var b=t.cookie&&t.cookie.split(";")||[],c=0;c<b.length;c++){for(var d=b[c];" "===d.charAt(0);)d=d.substring(1,d.length);if(0===d.indexOf(u(a)+"=")){var e=decodeURIComponent(d.substring(n.length+a.length+1,d.length));try{var f=JSON.parse(e);return j(f)}catch(g){return e}}}return null},B=function(){return q};return{isSupported:v,getStorageType:B,set:w,get:x,deriveKey:u,cookie:{isSupported:y,set:z,get:A}}}}(b,window.angular),function(a,b,c){"use strict";function d(a){var b,c,d,e,f,g=p;this.setInterceptFunction=function(a){g=a},this.getPrivateLoggingObject=function(){return{debug:q(b)?p:b,info:q(c)?p:c,warn:q(d)?p:d,error:q(e)?p:e,log:q(f)?p:f}};var h=function(a,b){return function(){var c=[].slice.call(arguments);g(c[0],b),a.apply(null,c)}};a.decorator("$log",["$delegate",function(a){return b=a.debug,c=a.info,d=a.warn,e=a.error,f=a.log,a.debug=h(b,"debug"),a.info=h(c,"info"),a.warn=h(d,"warn"),a.error=h(e,"error"),a.log=h(f,"log"),a}])}function e(a){var b,c=p;this.setInterceptFunction=function(a){c=a},this.getPrivateExceptionHanlder=function(){return q(b)?p:b},a.decorator("$exceptionHandler",["$delegate",function(a){return b=a,function(a,d){r||c(a,d),b(a,d)}}])}var f,g,h="angular:0.2.6",i="https://dc.services.visualstudio.com/v2/track",j=(a.isDefined,a.isUndefined),k=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},l=a.isObject,m=a.isArray,n=a.isString,o=a.extend,p=(a.toJson,a.fromJson,a.forEach,a.noop),q=function(a){return j(a)||null===a},r=!1,s=function(){for(var a=[],b="0123456789abcdef",c=0;36>c;c++)a[c]=b.substr(Math.floor(16*Math.random()),1);return a[8]=a[13]=a[18]=a[23]="-",a[14]="4",a[19]=b.substr(3&a[19]|8,1),a.join("")},t=a.module("ApplicationInsightsModule",[]);t.config(["$provide",function(a){f=new d(a),g=new e(a)}]),t.provider("applicationInsightsService",function(){function a(a,b,c,j,p,t){var u,v=f.getPrivateLoggingObject(),w=(g.getPrivateExceptionHanlder(),"application/json"),x="Microsoft.ApplicationInsights.",y={pageViews:x+"Pageview",traceMessage:x+"Message",events:x+"Event",metrics:x+"Metric",exception:x+"Exception"},z={pageViews:x+"PageviewData",traceMessage:x+"MessageData",events:x+"EventData",metrics:x+"MetricData",exception:x+"ExceptionData"},A=function(){var b="$$appInsights__uuid",c=a.get(b);return q(c)&&(c=s(),a.set(b,c)),c},B="$$appInsights__session",C=function(){var b={id:s(),accessed:(new Date).getTime()};return a.set(B,b),b},D=function(){var b=a.get(B);if(q(b))b=C();else{var c=q(b.accessed)?0:b.accessed,d=(new Date).getTime();d-c>e.sessionInactivityTimeout?b=C():(b.accessed=d,a.set(B,b))}return b.id},E=function(a){if(q(a))return null;if(!l(a))return v.warn("The value of the measurements parameter must be an object consisting of a string/number pairs."),null;var b={};for(var c in a)k(a[c])?b[c]=a[c]:v.warn("The value of measurement "+c+" is not a number.");return b},F=function(a){if(q(a))return null;if(!l(a))return v.warn("The value of the properties parameter must be an object consisting of a string/string pairs."),null;var b={};for(var c in a){var d=a[c];q(d)||l(d)||m(d)?v.warn("The value of property "+c+" could not be determined to be a string or number."):b[c]=d}return b},G=function(a){var b=["debug","info","warn","error"],c=b.indexOf(a);return c>-1?c:0},H=function(a){var c={};for(var d in b.defaults.headers.common)c[d]=void 0;for(var e in b.defaults.headers.post)c[e]=void 0;c.Accept=w,c["Content-Type"]=w;var f={method:"POST",url:i,headers:c,data:a,withCredentials:!1};try{b(f).success(function(){r=!1}).error(function(){r=!0})}catch(g){}},I=function(a,b,c,d){var e=N(y.pageViews,z.pageViews,{ver:1,url:q(b)?p.absUrl():b,name:q(a)?p.path():a,properties:F(c),measurements:E(d)});H(e)},J=function(a,b,c){var d=N(y.events,z.events,{ver:1,name:a,properties:F(b),measurements:E(c)});H(d)},K=function(a,b,c){if(!q(a)&&n(a)){var d=N(y.traceMessage,z.traceMessage,{ver:1,message:a,severityLevel:G(b),properties:F(c)});H(d)}},L=function(a,b,c){var d=N(y.metrics,z.metrics,{ver:1,metrics:[{name:a,value:b}],properties:F(c)});H(d)},M=function(a){if(!q(a)){var b=t.parse(a),c=N(y.exception,z.exception,{ver:1,handledAt:"Unhandled",exceptions:[{typeName:a.name,message:a.message,stack:a.stack,parsedStack:b,hasFullStack:!q(b)}]});H(c)}},N=function(a,b,e){return u&&(e.properties=e.properties||{},o(e.properties,u)),{name:a,time:(new Date).toISOString(),ver:1,iKey:d,user:{id:A()},session:{id:D()},operation:{id:s()},device:{id:"browser",locale:c.id,resolution:j.screen.availWidth+"x"+j.screen.availHeight},internal:{sdkVersion:h},data:{type:b,item:e}}},O=function(a){F(a),u=u||{},o(u,a)};return e.autoLogTracking&&f.setInterceptFunction(K),e.autoExceptionTracking&&g.setInterceptFunction(M),{trackPageView:I,trackTraceMessage:K,trackEvent:J,trackMetric:L,trackException:M,applicationName:e.applicationName,autoPageViewTracking:e.autoPageViewTracking,setCommonProperties:O}}var d="",e={applicationName:"",autoPageViewTracking:!0,autoLogTracking:!0,autoExceptionTracking:!0,sessionInactivityTimeout:18e5};this.configure=function(a,b,c){n(b)?(d=a,e.applicationName=b,e.autoPageViewTracking=q(c)?!0:c):(o(e,b),d=a)},this.$get=["$http","$locale","$window","$location","$rootScope","$parse","$document",function(d,e,f,g,h,i,j){var k=c({window:f,rootScope:h,document:j,parse:i});return new a(k,d,e,f,g,b)}]}).run(["$rootScope","$location","applicationInsightsService",function(a,b,c){a.$on("$locationChangeSuccess",function(){c.autoPageViewTracking&&c.trackPageView(c.applicationName+b.path())})}])}(b.angular,b.errorStackParser,b.storage)}(window.angular);